load("//Config:buck_rule_macros.bzl", "static_library", "framework", "glob_map", "merge_maps")

framework(
    name = "MtProtoKit",
    srcs = glob([
        "*.m",
        "MtProtoKit/*.m",
        "thirdparty/AFNetworking/*.m",
        "thirdparty/AsyncSocket/*.m",
    ]),
    headers = merge_maps([
        glob_map(glob([
            "*.h",
            "MtProtoKit/*.h",
            "thirdparty/AFNetworking/*.h",
            "thirdparty/AsyncSocket/*.h",
        ])),
    ]),
    exported_headers = [
        "MtProtoKit/MTTime.h",
        "MtProtoKit/MTTimer.h",
        "MtProtoKit/MTLogging.h",
        "MtProtoKit/MTEncryption.h",
        "MtProtoKit/MTInternalId.h",
        "MtProtoKit/MTQueue.h",
        "MtProtoKit/MTOutputStream.h",
        "MtProtoKit/MTInputStream.h",
        "MtProtoKit/MTSerialization.h",
        "MtProtoKit/MTExportedAuthorizationData.h",
        "MtProtoKit/MTRpcError.h",
        "MtProtoKit/MTKeychain.h",
        "MtProtoKit/MTFileBasedKeychain.h",
        "MtProtoKit/MTContext.h",
        "MtProtoKit/MTTransportScheme.h",
        "MtProtoKit/MTDatacenterTransferAuthAction.h",
        "MtProtoKit/MTDatacenterAuthAction.h",
        "MtProtoKit/MTDatacenterAuthMessageService.h",
        "MtProtoKit/MTDatacenterAddress.h",
        "MtProtoKit/MTDatacenterAddressSet.h",
        "MtProtoKit/MTDatacenterAuthInfo.h",
        "MtProtoKit/MTDatacenterSaltInfo.h",
        "MtProtoKit/MTDatacenterAddressListData.h",
        "MtProtoKit/MTProto.h",
        "MtProtoKit/MTSessionInfo.h",
        "MtProtoKit/MTTimeFixContext.h",
        "MtProtoKit/MTPreparedMessage.h",
        "MtProtoKit/MTOutgoingMessage.h",
        "MtProtoKit/MTIncomingMessage.h",
        "MtProtoKit/MTMessageEncryptionKey.h",
        "MtProtoKit/MTMessageService.h",
        "MtProtoKit/MTMessageTransaction.h",
        "MtProtoKit/MTTimeSyncMessageService.h",
        "MtProtoKit/MTRequestMessageService.h",
        "MtProtoKit/MTRequest.h",
        "MtProtoKit/MTRequestContext.h",
        "MtProtoKit/MTRequestErrorContext.h",
        "MtProtoKit/MTDropResponseContext.h",
        "MtProtoKit/MTApiEnvironment.h",
        "MtProtoKit/MTResendMessageService.h",
        "MtProtoKit/MTNetworkAvailability.h",
        "MtProtoKit/MTTransport.h",
        "MtProtoKit/MTTransportTransaction.h",
        "MtProtoKit/MTTcpTransport.h",
        "MtProtoKit/MTHttpRequestOperation.h",
        "MTAtomic.h",
        "MTBag.h",
        "MTDisposable.h",
        "MTSubscriber.h",
        "MTSignal.h",
        "MTNetworkUsageCalculationInfo.h",
        "MTNetworkUsageManager.h",
        "MTBackupAddressSignals.h",
        "thirdparty/AFNetworking/AFURLConnectionOperation.h",
        "thirdparty/AFNetworking/AFHTTPRequestOperation.h",
        "MTProxyConnectivity.h",
        "MTGzip.h",
        "MTDatacenterVerificationData.h",
    ],
    visibility = ["PUBLIC"],
    deps = [
        "//submodules/EncryptionProvider:EncryptionProvider",
    ],
    frameworks = [
        "$SDKROOT/System/Library/Frameworks/Foundation.framework",
        "$SDKROOT/System/Library/Frameworks/Security.framework",
    ],
)
